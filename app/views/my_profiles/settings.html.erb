<section class="mx-auto max-w-4xl space-y-6 px-4 py-12">
  <div class="flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-bold text-slate-900 dark:text-slate-100">Settings – @<%= @profile.login %></h1>
      <% if @profile.last_pipeline_status.present? %>
        <span class="inline-block mt-2 text-xs px-2 py-1 rounded border
          <%= case @profile.last_pipeline_status
             when 'queued' then 'bg-yellow-50 border-yellow-200 text-yellow-800 dark:bg-yellow-900/20 dark:border-yellow-800 dark:text-yellow-200'
             when 'success' then 'bg-green-50 border-green-200 text-green-800 dark:bg-green-900/20 dark:border-green-800 dark:text-green-200'
             when 'failure' then 'bg-red-50 border-red-200 text-red-800 dark:bg-red-900/20 dark:border-red-800 dark:text-red-200'
             else 'bg-slate-100 border-slate-200 text-slate-700 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300' end %>
        "><%= @profile.last_pipeline_status.capitalize %></span>
      <% end %>
      <% if @profile.last_pipeline_error.present? %>
        <p class="mt-2 text-sm text-red-600 dark:text-red-400"><%= @profile.last_pipeline_error %></p>
      <% end %>
    </div>
    <div class="flex items-center gap-2">
      <%= link_to "Back", my_profiles_path, class: "rounded border px-3 py-1.5 text-slate-700 hover:bg-slate-50 dark:text-slate-300 dark:border-slate-700 dark:hover:bg-slate-800" %>
    </div>
  </div>

  <div class="rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800">
    <h2 class="text-lg font-semibold text-slate-900 dark:text-slate-100 mb-3">Regenerate</h2>
    <p class="text-sm text-slate-600 dark:text-slate-300 mb-3">Re-run the full pipeline (sync → images → screenshots → optimize). This queues a background job.</p>
    <%= button_to "Queue Regeneration", regenerate_my_profile_path(username: @profile.login), method: :post, class: "rounded bg-slate-900 px-4 py-2 text-white dark:bg-slate-100 dark:text-slate-900" %>
  </div>

  <div class="grid gap-6 md:grid-cols-3">
    <div class="rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800">
      <h3 class="font-medium text-slate-900 dark:text-slate-100 mb-2">OG</h3>
      <% if @asset_og&.public_url.present? %>
        <a href="<%= @asset_og.public_url %>" target="_blank" class="text-blue-600 dark:text-blue-400">View</a>
      <% else %>
        <a href="<%= og_image_path(login: @profile.login) %>" target="_blank" class="text-blue-600 dark:text-blue-400">Generate/Fetch</a>
      <% end %>
    </div>
    <div class="rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800">
      <h3 class="font-medium text-slate-900 dark:text-slate-100 mb-2">Card</h3>
      <% if @asset_card&.public_url.present? %>
        <a href="<%= @asset_card.public_url %>" target="_blank" class="text-blue-600 dark:text-blue-400">View</a>
      <% else %>
        <a href="<%= card_preview_path(login: @profile.login) %>" target="_blank" class="text-blue-600 dark:text-blue-400">Preview</a>
      <% end %>
    </div>
    <div class="rounded-lg border border-slate-200 bg-white p-4 shadow-sm dark:border-slate-700 dark:bg-slate-800">
      <h3 class="font-medium text-slate-900 dark:text-slate-100 mb-2">Simple</h3>
      <% if @asset_simple&.public_url.present? %>
        <a href="<%= @asset_simple.public_url %>" target="_blank" class="text-blue-600 dark:text-blue-400">View</a>
      <% else %>
        <a href="<%= card_simple_path(login: @profile.login) %>" target="_blank" class="text-blue-600 dark:text-blue-400">Preview</a>
      <% end %>
    </div>
  </div>
</section>

