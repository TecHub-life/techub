<section class="mx-auto max-w-6xl space-y-6 px-4 py-12 min-h-screen h-full">
  <% if defined?(@ownership_removed_notices) && @ownership_removed_notices.present? %>
    <div class="rounded border border-yellow-200 bg-yellow-50 p-4 text-yellow-900 dark:border-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-200">
      <ul class="list-disc pl-5 space-y-1">
        <% @ownership_removed_notices.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <h1 class="text-2xl font-bold text-slate-900 dark:text-slate-100">My Profiles</h1>
  <p class="text-slate-600 dark:text-slate-300">Profiles you own.</p>
  <div class="text-sm text-slate-500 dark:text-slate-400">Owned: <span class="font-mono"><%= @ownership_count %></span> / <span class="font-mono"><%= @ownership_cap %></span> (remaining <span class="font-mono"><%= @ownership_remaining %></span>)</div>

  <% if @profiles.any? %>
    <div class="divide-y divide-slate-200 dark:divide-slate-700 rounded border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800">
      <% @profiles.each do |profile| %>
        <div class="flex items-center justify-between p-4">
          <div class="flex items-center gap-4">
            <img src="<%= avatar_image_url_for(profile) %>" alt="<%= profile.login %>" class="w-10 h-10 rounded" onerror="this.onerror=null; this.src='<%= asset_path("android-chrome-512x512.jpg") %>'">
            <div>
              <a href="<%= profile_path(username: profile.login) %>" class="font-medium text-slate-900 dark:text-slate-100 hover:text-blue-600 dark:hover:text-blue-400">@<%= profile.login %></a>

              <% if profile.last_pipeline_status.present? %>
                <span class="ml-2 text-xs px-2 py-0.5 rounded border
                  <%= case profile.last_pipeline_status
                     when 'queued' then 'bg-yellow-50 border-yellow-200 text-yellow-800 dark:bg-yellow-900/20 dark:border-yellow-800 dark:text-yellow-200'
                     when 'success' then 'bg-green-50 border-green-200 text-green-800 dark:bg-green-900/20 dark:border-green-800 dark:text-green-200'
                     when 'failure' then 'bg-red-50 border-red-200 text-red-800 dark:bg-red-900/20 dark:border-red-800 dark:text-red-200'
                     else 'bg-slate-100 border-slate-200 text-slate-700 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-300' end %>
                "><%= profile.last_pipeline_status.capitalize %></span>
              <% end %>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <%= link_to "Settings", my_profile_settings_path(username: profile.login), class: "text-sm text-slate-700 hover:text-blue-600 dark:text-slate-300" %>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="text-slate-500 dark:text-slate-400">You have no profiles yet.</p>
  <% end %>

  <div>
    <a href="<%= submit_path %>" class="inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-slate-700 to-slate-900 px-4 py-2 text-sm font-semibold text-white shadow-sm transition hover:shadow-md hover:scale-[1.01] hover:from-slate-600 hover:to-slate-800 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-slate-700 dark:from-slate-600 dark:to-slate-800 dark:hover:from-slate-500 dark:hover:to-slate-700">Submit a Profile</a>
  </div>
</section>
